networks:
  traefik:
    external: true
  freshrss-feeds:
    external: true
  internal:
    name: nitter_default

services:
  nitter:
    container_name: nitter
    image: docker.io/zedeus/nitter:51b54852dcf617c6131376a469c537ab6b8326e3-arm64@sha256:8938fcd9ee2209b3bf1abcf6ed32b53003868dd1fcce0d76b5a0269029007c48
    restart: unless-stopped
    read_only: true
    tmpfs:
      - /tmp
    depends_on:
      - valkey
    volumes:
      - /opt/secrets/nitter.conf:/src/nitter.conf:ro,z
      - /opt/secrets/nitter-sessions.jsonl:/src/sessions.jsonl:ro,z
    environment:
      - NITTER_CONF_FILE=/src/nitter.conf
      - NITTER_SESSIONS_FILE=/src/sessions.jsonl
    networks:
      - traefik
      - freshrss-feeds
      - internal

  valkey:
    container_name: nitter-valkey
    image: docker.io/valkey/valkey:9.0.2-alpine@sha256:68677f85c863830af7836ff07c4a13b7f085ebeff62f4dedb71499ca27d229f2
    restart: unless-stopped
    read_only: true
    tmpfs:
      - /tmp
    networks:
      - internal
    volumes:
      - /opt/data/nitter/valkey:/data:z
